<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TSV ChatBot</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #111; color: #eee; }
    #chatbox { border: 1px solid #444; padding: 10px; height: 400px; overflow-y: auto; background:#222; border-radius: 6px; }
    .user { color: #ff9800; margin: 5px 0; }
    .bot { color: #4caf50; margin: 5px 0; }
    #userInput { width: 75%; padding: 8px; border-radius: 6px; border: 1px solid #555; background:#333; color:#fff; }
    #sendBtn { padding: 8px 12px; border: none; background: #ff9800; color: #fff; border-radius: 6px; cursor: pointer; }
    #sendBtn:hover { background: #e68900; }
  </style>
</head>
<body>
  <h2>TSV ChatBot</h2>
  <div id="chatbox"></div>
  <input type="text" id="userInput" placeholder="Type your message here" />
  <button id="sendBtn">Send</button>

  <script>
    const chatbox = document.getElementById("chatbox");
    const userInput = document.getElementById("userInput");
    const sendBtn = document.getElementById("sendBtn");

    // Show greeting on page load
    window.onload = () => {
      const greeting = "üëã Hi! I‚Äôm TSV ChatBot. How can I help you today?";
      chatbox.innerHTML += `<div class="bot"><b>Bot:</b> ${greeting}</div>`;
      chatbox.scrollTop = chatbox.scrollHeight;
    };

    async function sendMessage() {
      const message = userInput.value.trim();
      if (!message) return;

      chatbox.innerHTML += `<div class="user"><b>You:</b> ${message}</div>`;
      userInput.value = "";
      chatbox.scrollTop = chatbox.scrollHeight;

      try {
        // Call Hugging Face Gradio API
        const response = await fetch("https://kuysdrew-TSVChatBot.hf.space/run/predict", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ data: [message] })
        });

        const result = await response.json();
        // Gradio returns reply in result.data
        const botReply = result.data[0];

        chatbox.innerHTML += `<div class="bot"><b>Bot:</b> ${botReply}</div>`;
        chatbox.scrollTop = chatbox.scrollHeight;
      } catch (err) {
        console.error(err);
        chatbox.innerHTML += `<div class="bot"><b>Bot:</b> ‚ùå Error reaching the API.</div>`;
      }
    }

    sendBtn.addEventListener("click", sendMessage);
    userInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") sendMessage();
    });
  </script>
</body>
</html>